diff --git a/Microsoft/Xaml/XamlCompiler/CodeGenerators/WRL_PagePass2.tt b/Microsoft/Xaml/XamlCompiler/CodeGenerators/WRL_PagePass2.tt
new file mode 100644
index 0000000..470c980
--- /dev/null
+++ b/Microsoft/Xaml/XamlCompiler/CodeGenerators/WRL_PagePass2.tt
@@ -0,0 +1,609 @@
+ï»¿<#@ template language="C#" inherits="WRL_CodeGenerator<PageDefinition>" visibility="internal" linePragmas="false"#>
+<#@ import namespace="System.Linq" #>
+<#@ import namespace="Microsoft.Xaml.DirectUI" #>
+<#@ import namespace="Microsoft.UI.Xaml.Markup.Compiler" #>
+<#@ import namespace="Microsoft.UI.Xaml.Markup.Compiler.CodeGen" #>
+<#@ import namespace="Microsoft.Windows.UI.Xaml.Build.Tasks.Utilities" #>
+//------------------------------------------------------------------------------
+//     This code was generated by a trole.
+//
+//     Changes to this file may cause incorrect behavior and will be lost if
+//     the code is regenerated.
+//------------------------------------------------------------------------------
+#include "pch.h"
+
+<#  foreach (var includeFile in Model.NeededLocalXamlHeaderFiles) { #>
+#include "<#=includeFile#>"
+<#  }#>
+
+#pragma warning(push)
+#pragma warning(disable: 4100) // unreferenced formal parameter
+
+namespace <#=Colonize(Model.CodeInfo.ClassName.Namespace)#>
+{
+    using IApplication = <#=Projection(DUI.NamespaceWindowsUIXaml)#>::IApplication;
+    using ComponentResourceLocation = <#=Projection(DUI.NamespaceWindowsUIXamlControlsPrimitives)#>::ComponentResourceLocation;
+    using IDataTemplateStatics2 = <#=Projection(DUI.NamespaceWindowsUIXaml)#>::IDataTemplateStatics2;
+    using IDependencyObject = <#=Projection(DUI.NamespaceWindowsUIXaml)#>::IDependencyObject;
+    using IDependencyProperty = <#=Projection(DUI.NamespaceWindowsUIXaml)#>::IDependencyProperty;
+    using IComponentConnector = <#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IComponentConnector;
+    using IUriRuntimeClass = <#=Projection(DUI.NamespaceWindowsFoundation)#>::IUriRuntimeClass;
+    using IUriRuntimeClassFactory = <#=Projection(DUI.NamespaceWindowsFoundation)#>::IUriRuntimeClassFactory;
+    using IXamlBindingHelperStatics = <#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlBindingHelperStatics;
+    using IApplicationStatics = <#=Projection(DUI.NamespaceWindowsUIXaml)#>::IApplicationStatics;
+    using IXamlMarkupHelperStatics = <#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlMarkupHelperStatics;
+
+<#  if (Model.ApiInformationDeclarations.Any()) { #>
+    // Api Information for conditional namespace declarations
+<#      foreach (var apiInformation in Model.ApiInformationDeclarations) { #>
+    bool <#=Model.CodeInfo.ClassName.ShortName#>_<#= apiInformation.MemberFriendlyName #>;
+<#      } #>
+
+<#  } #>
+<#  if (Model.CodeInfo.IsUsingCompiledBinding) { /*Place this before the component's implementation functions*/ #>
+<#      foreach (BindUniverse bindUniverse in Model.CodeInfo.BindUniverses) { #>
+<#          if (bindUniverse.NeedsCppBindingTrackingClass) { #>
+
+<#          IncludeTemplate<WRL_PageBindingTracking>(Model, bindUniverse); #>
+<#          } #>
+
+<#          IncludeTemplate<WRL_PageBinding>(Model, bindUniverse); #>
+<#      }#>
+<# } #>
+<# Output_InitializeComponent(); #>
+
+<# Output_ConnectMethod(); #>
+
+<# if (Features.xLoad.ExistsInVersion(ProjectInfo.TargetPlatformMinVersion)) { #>
+<#   if (Model.UnloadableFields.Count() > 0) { #>
+<#        Output_UnloadMethods(); #>
+<#   } else { #>
+<#        Output_EmptyUnloadMethods(); #>
+<#   } #>
+<# } #>
+
+<# if (Model.CodeInfo.BindStatus != BindStatus.None) { #>
+<#      Output_GetBindingConnectorMethod(); #>
+<# } else { #>
+<#      Output_EmptyGetBindingConnectorMethod(); #>
+<# } /*OG compiled binding code right below line*/ #>
+}
+
+<# if (ProjectInfo.GenerateIncrementalTypeInfo) { #>
+
+namespace <#=Colonize(ProjectInfo.RootNamespace)#>
+{
+<#      foreach(var entry in Model.TypeInfos.Where(t => t.StandardName == Model.CodeInfo.ClassType.StandardName)) { #>
+<#        IncludeTemplate<CppWinRT_MetadataDelegates>(entry, false); #>
+<#      } #>
+}
+<#  } #>
+
+#pragma warning(pop)
+
+<#+ private void Output_InitializeOuter() { #>
+        ComPtr<<#=Projection(Model.CodeInfo.BaseTypeName).ToFactoryInterface()#>> superclassFactory;
+        hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+            ::Microsoft::WRL::Wrappers::HStringReference(<#=Model.CodeInfo.BaseType.ToRuntimeClassNameConstant()#>).Get(),
+            &superclassFactory);
+        if (FAILED(hr)) return hr;
+
+        ComPtr<::IInspectable> spInnerInspectable;
+        ComPtr<<#=Projection(Model.CodeInfo.BaseTypeName).ToInterface()#>> spInner;
+        hr = superclassFactory->CreateInstance(
+            static_cast<::IInspectable*>(CastToUnknown()), &spInnerInspectable, &spInner);
+        if (FAILED(hr)) return hr;
+
+        hr = SetComposableBasePointers(spInnerInspectable.Get(), superclassFactory.Get());
+        if (FAILED(hr)) return hr;
+<#+ } #>
+
+<#+ private void Output_CallLoadComponentWithResourceLocation(string resourceLocatorAccess, string loadType) { #>
+        ComPtr<IApplicationStatics> applicationStatics;
+        hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+            ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_UI_Xaml_Application).Get(),
+            &applicationStatics);
+        if (FAILED(hr)) return hr;
+
+        ComPtr<IUriRuntimeClass> defaultUri;
+        hr = applicationStatics->LoadComponentWithResourceLocation(
+            static_cast<IInspectable*>(CastToUnknown()), <#=resourceLocatorAccess#>,
+            ComponentResourceLocation::ComponentResourceLocation_<#=loadType#>);
+        if (FAILED(hr)) return hr;
+<#+ } #>
+
+<#+ private void Output_InitializeComponent() { #>
+<#+     string defaultUri = Model.GetLoadComponentUri(Model.CodeInfo.PriIndexName, Model.CodeInfo.BaseApparentRelativePath);#>
+<#+     string loadType = !string.IsNullOrEmpty(Model.CodeInfo.XamlComponentResourceLocation) ? Model.CodeInfo.XamlComponentResourceLocation : (ProjectInfo.IsLibrary ? "Nested" : "Application"); #>
+<#+     if(Model.CodeInfo.PerXamlFileInfo.Count > 1) { #>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::_InitializeComponent()
+    {
+        using namespace Microsoft::WRL;
+
+        ComPtr<IUriRuntimeClassFactory> uriFactory;
+        HRESULT hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+            ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_Foundation_Uri).Get(),
+            &uriFactory);
+        if (FAILED(hr)) return hr;
+
+        ComPtr<IUriRuntimeClass> defaultUri;
+        hr = uriFactory->CreateUri(
+            ::Microsoft::WRL::Wrappers::HStringReference(L"<#=defaultUri#>").Get(),
+            &defaultUri);
+        if (FAILED(hr)) return hr;
+
+        hr = _InitializeComponent(defaultUri.Get());
+        if (FAILED(hr)) return hr;
+
+        return hr;
+    }
+
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::_InitializeComponent(IUriRuntimeClass* resourceLocator)
+    {
+        using namespace Microsoft::WRL;
+        HRESULT hr;
+
+<#+         Output_InitializeOuter(); #>
+
+        if (!_contentLoaded)
+        {
+            _contentLoaded = true;
+<#+         if (Model.ApiInformationDeclarations.Any()) { #>
+
+<#+             foreach (var apiInformation in Model.ApiInformationDeclarations) { #>
+            <#=Model.CodeInfo.ClassName.ShortName#>_<#= apiInformation.MemberFriendlyName #> = <#= apiInformation.CodeGen().CallExpression #>;
+<#+             } #>
+<#+         } #>
+
+<#+         Output_CallLoadComponentWithResourceLocation("resourceLocator", loadType); #>
+        }
+
+        return hr;
+    }
+<#+     } else { #>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::_InitializeComponent()
+    {
+        using namespace Microsoft::WRL;
+        HRESULT hr;
+
+<#+         Output_InitializeOuter(); #>
+
+        if (!_contentLoaded)
+        {
+            _contentLoaded = true;
+<#+         if (Model.ApiInformationDeclarations.Any()) { #>
+
+<#+             foreach (var apiInformation in Model.ApiInformationDeclarations) { #>
+            <#=Model.CodeInfo.ClassName.ShortName#>_<#= apiInformation.MemberFriendlyName #> = <#= apiInformation.CodeGen().CallExpression #>;
+<#+             } #>
+<#+         } #>
+
+            ComPtr<IUriRuntimeClassFactory> uriFactory;
+            hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+                ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_Foundation_Uri).Get(),
+                &uriFactory);
+            if (FAILED(hr)) return hr;
+
+            ComPtr<IUriRuntimeClass> resourceLocator;
+            hr = uriFactory->CreateUri(
+                ::Microsoft::WRL::Wrappers::HStringReference(L"<#=defaultUri#>").Get(),
+                &resourceLocator);
+            if (FAILED(hr)) return hr;
+
+<#+         Output_CallLoadComponentWithResourceLocation("resourceLocator.Get()", loadType); #>
+        }
+
+        return hr;
+    }
+<#+     } #>
+<#+ } #>
+
+<#+ private void Output_ConnectMethod()#>
+<#+ {#>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::Connect(INT32 connectionId, ::IInspectable* target)
+    {
+        using namespace Microsoft::WRL;
+        HRESULT hr = S_OK;
+
+<#+     if (Model.ConnectableElements.Any()) { #>
+        switch (connectionId)
+        {
+<#+         foreach (var element in Model.ConnectableElements) { #>
+        case <#=element.ConnectionId#>:
+            {
+<#+             Output_ConnectionId_Case(element); #>
+            }
+            break;
+<#+         }#>
+        }
+<#+     } else { #>
+        UNREFERENCED_PARAMETER(connectionId);
+        UNREFERENCED_PARAMETER(target);
+        _contentLoaded = true;
+<#+     } #>
+
+        return hr;
+    }
+<#+ }#>
+
+<#+ private void Output_EmptyUnloadMethods()#>
+<#+ {#>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::DisconnectUnloadedObject(INT32)
+    {
+        return E_INVALIDARG;
+    }
+
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::UnloadObject(IDependencyObject*)
+    {
+        return E_INVALIDARG;
+    }
+<#+ } #>
+
+<#+ private void Output_UnloadMethods()#>
+<#+ {#>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::UnloadObject(IDependencyObject* unloadableObject)
+    {
+        using namespace Microsoft::WRL;
+        HRESULT hr = S_OK;
+
+        if (unloadableObject)
+        {
+<#+         foreach (var element in Model.UnloadableFields) { #>
+            // <#=element.LineNumberAndXamlFile#>
+<#+             Output_ApiInformationCall_Push(element.ApiInformation, Indent.OneTab); #>
+            if (__XAML_IsSameObject(unloadableObject, _<#=element.ElementName#>.Get()))
+            {
+                hr = DisconnectUnloadedObject(<#=element.ConnectionId#>);
+                if (FAILED(hr)) return hr;
+            }
+<#+             Output_ApiInformationCall_Pop(element.ApiInformation, Indent.OneTab); #>
+<#+         } #>
+            ComPtr<IXamlMarkupHelperStatics> spXamlMarkupHelperStatics;
+            hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+                ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_UI_Xaml_Markup_XamlMarkupHelper).Get(),
+                &spXamlMarkupHelperStatics);
+            if (FAILED(hr)) return hr;
+
+            hr = spXamlMarkupHelperStatics->UnloadObject(unloadableObject);
+            if (FAILED(hr)) return hr;
+        }
+
+        return hr;
+    }
+
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::DisconnectUnloadedObject(INT32 connectionId)
+    {
+        using namespace Microsoft::WRL;
+        HRESULT hr = S_OK;
+
+        switch(connectionId)
+        {
+<#+         foreach (var element in Model.DeferrableElements)#>
+<#+         {#>
+            case <#=element.ConnectionId#>: // <#=element.LineNumberAndXamlFile#>
+            {
+<#+             foreach (var childElem in element.Children) #>
+<#+             {#>
+<#+                 if (childElem.HasFieldDefinition) #>
+<#+                 {#>
+                hr = DisconnectUnloadedObject(<#=childElem.ConnectionId#>);
+                if (FAILED(hr)) return hr;
+<#+                 }#>
+<#+                 if (childElem.HasBindAssignments || element.HasRootNamedElementStep) #>
+<#+                 {#>
+                hr = Bindings->DisconnectUnloadedObject(<#=childElem.ConnectionId#>);
+                if (FAILED(hr)) return hr;
+<#+                 }#>
+<#+             }#>
+<#+             if (element.HasBindAssignments || element.HasRootNamedElementStep) #>
+<#+             {#>
+                hr = Bindings->DisconnectUnloadedObject(<#=element.ConnectionId#>);
+                if (FAILED(hr)) return hr;
+<#+             }#>
+<#+             FieldDefinition fieldInfo = element.FieldDefinition; #>
+<#+             if(fieldInfo != null) #>
+<#+             { #>
+<#+                 Output_ApiInformationCall_Push(element.ApiInformation, Indent.TwoTabs); #>
+                _<#=fieldInfo.FieldName#>.Reset();
+<#+                 Output_ApiInformationCall_Pop(element.ApiInformation, Indent.TwoTabs); #>
+<#+             } #>
+                break;
+            }
+<#+         }#>
+            default:
+            {
+                hr = E_INVALIDARG;
+            }
+        }
+
+        return hr;
+    }
+<#+ }#>
+
+<#+ private void Output_ConnectionId_Case(ConnectionIdElement element)#>
+<#+ {#>
+<#+     Output_PushDeprecated(element.Type.IsDeprecated()); #>
+<#+     Output_ApiInformationCall_Push(element.ApiInformation, Indent.TwoTabs); #>
+                ComPtr<<#=element.Type.WRLNameInterface()#>> targetElement;
+                hr = target->QueryInterface(IID_PPV_ARGS(&targetElement));
+                if (FAILED(hr)) return hr;
+<#+     if (element.HasFieldDefinition) {#>
+
+                _<#=element.FieldDefinition.FieldName#> = targetElement;
+<#+     }#>
+<#+     if (element.EventAssignments.Any()) { #>
+
+                WeakRef weakThis;
+                hr = AsWeak(static_cast<::IInspectable*>(CastToUnknown()), &weakThis);
+                if (FAILED(hr)) return hr;
+
+                EventRegistrationToken tokenIgnored;
+<#+     } #>
+<#+     foreach (EventAssignment ev in element.EventAssignments) { #>
+<#+         Output_ApiInformationCall_Push(ev.ApiInformation, Indent.TwoTabs); #>
+                {
+<#+         var needsCast = !string.Equals(ev.DeclaringType.FullDefaultInterfaceName, element.Type.WRLNameInterface(), StringComparison.Ordinal); #>
+<#+         var eventDeclaringTypeVarName = needsCast ? "spEventTemp" : "targetElement"; #>
+<#+         if (needsCast) { #>
+                    ComPtr<<#=ev.DeclaringType.FullDefaultInterfaceName#>> spEventTemp;
+                    hr = targetElement.As(&spEventTemp);
+                    if (FAILED(hr)) return hr;
+
+<#+         } #>
+                    hr = <#=eventDeclaringTypeVarName#>->add_<#=ev.EventName#>(Callback<<#=Projection(DUI.NamespaceWindowsUIXaml)#>::IRoutedEventHandler>(
+                        [weakThis](<#=ev.Parameters.Declaration()#>) -> HRESULT
+                        {
+                            HRESULT hr = S_OK;
+                            ComPtr<<#=Model.CodeInfo.ClassType.FullDefaultInterfaceName#>> strongThis;
+                            if (SUCCEEDED(weakThis.As(&strongThis)))
+                            {
+                                hr = static_cast<<#=Model.CodeInfo.ClassName.ShortName#>*>(strongThis.Get())-><#=ev.HandlerName#>(<#=ev.Parameters.ForCall()#>);
+                            }
+                            return hr;
+                        }).Get(), &tokenIgnored);
+                    if (FAILED(hr)) return hr;
+                }
+<#+         Output_ApiInformationCall_Pop(ev.ApiInformation, Indent.TwoTabs); #>
+<#+     } #>
+<#+     Output_ApiInformationCall_Pop(element.ApiInformation, Indent.TwoTabs); #>
+<#+     Output_PopDeprecated(element.Type.IsDeprecated()); #>
+<#+ }#>
+
+<#+ private void Output_EmptyGetBindingConnectorMethod()#>
+<#+ {#>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::GetBindingConnector(INT32, ::IInspectable*, IComponentConnector** result)
+    {
+        *result = nullptr;
+        return S_OK;
+    }
+<#+ } #>
+
+<#+ private void Output_GetBindingConnectorMethod()#>
+<#+ {#>
+    HRESULT <#=Model.CodeInfo.ClassName.ShortName#>::GetBindingConnector(INT32 connectionId, ::IInspectable* target, IComponentConnector** result)
+    {
+        using namespace Microsoft::WRL;
+
+        *result = nullptr;
+        HRESULT hr = S_OK;
+
+        ComPtr<<#=Globalize(ProjectInfo.RootNamespace)#>::XamlBindings> bindings;
+        switch (connectionId)
+        {
+<#+     foreach (var element in Model.AllConnectionIdElements) { #>
+<#+         if (element.IsBindingRoot) { #>
+            case <#=element.ConnectionId#>: // <#=element.LineNumberAndXamlFile#>
+                {
+<#+             Output_PushDeprecated(element.Type.IsDeprecated());#>
+<#+                 if (element.Type.IsDerivedFromControlTemplate()) #>
+<#+                 {#>
+                    {
+                        ComPtr<<#=element.TemplatedParentType.WRLNameInterface()#>> <#=element.ElementTemplatedParentCodeName#>;
+                        if (SUCCEEDED(target->QueryInterface(IID_PPV_ARGS(&<#=element.ElementTemplatedParentCodeName#>))))
+                        {
+                            {
+                                HRESULT hrInit = S_OK;
+                                <#=element.BindUniverse.BindingsClassName#>* objBindings = new(std::nothrow) <#=element.BindUniverse.BindingsClassName#>(&hrInit);
+                                hr = objBindings ? S_OK : E_OUTOFMEMORY;
+                                if (FAILED(hr)) return hr;
+
+                                hr = hrInit;
+                                if (FAILED(hr)) return delete objBindings, hr;
+
+                                bool fSetIgnored;
+                                hr = objBindings->SetDataRoot(<#=element.ElementTemplatedParentCodeName#>.Get(), &fSetIgnored);
+                                if (FAILED(hr)) return delete objBindings, hr;
+
+                                hr = MakeAndInitialize<<#=Globalize(ProjectInfo.RootNamespace)#>::XamlBindings>(&bindings, objBindings.Get());
+                                if (FAILED(hr)) return delete objBindings, hr;
+                            }
+                            {
+                                ComPtr<<#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlBindingHelperStatics> xamlBindingHelperStatics;
+                                hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+                                    ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_UI_Xaml_Markup_XamlBindingHelper).Get(),
+                                    &xamlBindingHelperStatics);
+                                if (FAILED(hr)) return hr;
+
+                                ComPtr<IDependencyObject> dependencyObject;
+                                hr = <#=element.ElementTemplatedParentCodeName#>.As(&dependencyObject);
+                                if (FAILED(hr)) return hr;
+
+                                ComPtr<<#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IDataTemplateComponent> dataTemplateComponent;
+                                hr = bindings.As(&dataTemplateComponent);
+                                if (FAILED(hr)) return hr;
+
+                                hr = xamlBindingHelperStatics->SetDataTemplateComponent(
+                                    dependencyObject.Get(), dataTemplateComponent.Get());
+                                if (FAILED(hr)) return hr;
+                            }
+                        }
+                    }
+<#+                 } else {#>
+                    ComPtr<<#=element.Type.WRLNameInterface()#>> <#=element.ElementCodeName#>;
+                    hr = target->QueryInterface(IID_PPV_ARGS(&<#=element.ElementCodeName#>));
+                    if (FAILED(hr)) return hr;
+
+                    {
+                        HRESULT hrInit = S_OK;
+                        <#=element.BindUniverse.BindingsClassName#>* objBindings = new(std::nothrow) <#=element.BindUniverse.BindingsClassName#>(&hrInit);
+                        hr = objBindings ? S_OK : E_OUTOFMEMORY;
+                        if (FAILED(hr)) return hr;
+
+                        hr = hrInit;
+                        if (FAILED(hr)) return delete objBindings, hr;
+
+                        {
+<#+                     if (!element.IsBindingFileRoot) { #>
+                            ComPtr<IFrameworkElement> frameworkElement;
+                            hr = <#=element.ElementCodeName#>.As(&frameworkElement);
+                            if (FAILED(hr)) return delete objBindings, hr;
+
+                            ComPtr<::IInspectable> dataContext;
+                            hr = frameworkElement->get_DataContext(&dataContext);
+                            if (FAILED(hr)) return delete objBindings, hr;
+
+<#+                     }#>
+                            bool fSetIgnored;
+                            hr = objBindings->SetDataRoot(<#=element.IsBindingFileRoot ? "static_cast<IInspectable*>(CastToUnknown())" : "dataContext.Get()"#>, &fSetIgnored);
+                            if (FAILED(hr)) return delete objBindings, hr;
+                        }
+
+<#+                     if (element.BindUniverse.DistinctConvertersUsed.Count() > 0) { #>
+                        {
+<#+                         if (Model.CodeInfo.IsResourceDictionary) { #>
+                            ComPtr<<#=Projection(DUI.NamespaceWindowsUIXaml)#>::IResourceDictionary> resourceDictionary;
+                            hr = QueryInterface(IID_PPV_ARGS(&resourceDictionary));;
+                            if (FAILED(hr)) return delete objBindings, hr;
+
+                            hr = objBindings->SetConverterLookupRoot(resourceDictionary.Get());
+                            if (FAILED(hr)) return delete objBindings, hr;
+<#+                         } else { #>
+                            ComPtr<<#=Projection(DUI.NamespaceWindowsUIXaml)#>::IFrameworkElement> frameworkElement;
+                            hr = <#=element.ElementCodeName#>.As(&frameworkElement);
+                            if (FAILED(hr)) return delete objBindings, hr;
+
+                            hr = objBindings->SetConverterLookupRoot(frameworkElement.Get());
+                            if (FAILED(hr)) return delete objBindings, hr;
+<#+                         } #>
+                        }
+
+<#+                     }#>
+                        hr = MakeAndInitialize<<#=Globalize(ProjectInfo.RootNamespace)#>::XamlBindings>(&bindings, objBindings);
+                        if (FAILED(hr)) return delete objBindings, hr;
+                    }
+
+<#+                     if (element.IsBindingFileRoot) { #>
+                    Bindings = bindings;
+
+                    ComPtr<<#=Projection(DUI.NamespaceWindowsUIXaml)#>::IFrameworkElement3> frameworkElement3;
+                    hr = <#=element.ElementCodeName#>.As(&frameworkElement3);
+                    if (FAILED(hr)) return hr;
+
+                    EventRegistrationToken tokenIgnored;
+                    hr = frameworkElement3->add_Loading(
+                        Callback<__FITypedEventHandler_2_Windows__CUI__CXaml__CFrameworkElement_IInspectable>(
+                            bindings.Get(), &<#=Globalize(ProjectInfo.RootNamespace)#>::XamlBindings::Loading).Get(), &tokenIgnored);
+                    if (FAILED(hr)) return hr;
+<#+                     } else { #>
+                    {
+                        ComPtr<<#=Projection(DUI.NamespaceWindowsUIXaml)#>::IFrameworkElement> frameworkElement;
+                        hr = <#=element.ElementCodeName#>.As(&frameworkElement);
+                        if (FAILED(hr)) return hr;
+
+                        hr = bindings->SubscribeForDataContextChanged(frameworkElement.Get());
+                        if (FAILED(hr)) return hr;
+                    }
+
+                    {
+                        ComPtr<IDataTemplateStatics2> dataTemplateStatics;
+                        hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+                            ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_UI_Xaml_DataTemplate).Get(),
+                            &dataTemplateStatics);
+                        if (FAILED(hr)) return hr;
+
+                        ComPtr<IFrameworkElement> frameworkElement;
+                        hr = <#=element.ElementCodeName#>.As(&frameworkElement);
+                        if (FAILED(hr)) return hr;
+
+                        ComPtr<<#=Projection(DUI.NamespaceWindowsUIXaml)#>::IDataTemplateExtension> dataTemplateExtension;
+                        hr = <#=element.ElementCodeName#>.As(&dataTemplateExtension);
+                        if (FAILED(hr)) return hr;
+
+                        hr = dataTemplateStatics->SetExtensionInstance(
+                            frameworkElement.Get(), dataTemplateExtension.Get());
+                        if (FAILED(hr)) return hr;
+                    }
+                    {
+                        ComPtr<<#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlBindingHelperStatics> xamlBindingHelperStatics;
+                        hr = <#=Projection(DUI.NamespaceWindowsFoundation)#>::GetActivationFactory(
+                            ::Microsoft::WRL::Wrappers::HStringReference(RuntimeClass_Windows_UI_Xaml_Markup_XamlBindingHelper).Get(),
+                            &xamlBindingHelperStatics);
+                        if (FAILED(hr)) return hr;
+
+                        ComPtr<IDependencyObject> dependencyObject;
+                        hr = <#=element.ElementCodeName#>.As(&dependencyObject);
+                        if (FAILED(hr)) return hr;
+
+                        ComPtr<<#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IDataTemplateComponent> dataTemplateComponent;
+                        hr = <#=element.ElementCodeName#>.As(&dataTemplateComponent);
+                        if (FAILED(hr)) return hr;
+
+                        hr = xamlBindingHelperStatics->SetDataTemplateComponent(
+                            dependencyObject.Get(), dataTemplateComponent.Get());
+                        if (FAILED(hr)) return hr;
+                    }
+<#+                     }#>
+<#+                 }#>
+<#+                 Output_PopDeprecated(element.Type.IsDeprecated()); #>
+                }
+                break;
+<#+             }#>
+<#+         }#>
+        }
+
+        if (SUCCEEDED(hr) && bindings.Get())
+        {
+            *result = bindings.Detach();
+        }
+
+        return hr;
+    }
+<#+ }#>
+
+<#+     private void Output_PushDeprecated(bool isDeprecated)#>
+<#+     {#>
+<#+         if (isDeprecated) #>
+<#+         { #>
+#pragma warning( push )
+#pragma warning( disable : 4973 )
+<#+         } #>
+<#+     }#>
+
+<#+     private void Output_PopDeprecated(bool isDeprecated)#>
+<#+     {#>
+<#+         if (isDeprecated) #>
+<#+         { #>
+#pragma warning( pop )
+<#+         } #>
+<#+     }#>
+
+<#+ private void Output_ApiInformationCall_Push(ApiInformation apiInformation, Indent indent)#>
+<#+ {#>
+<#+     if (apiInformation != null) { #>
+<#+         PushIndent(indent); #>
+        if (<#=Model.CodeInfo.ClassName.ShortName#>_<#= apiInformation.MemberFriendlyName #>)
+        {
+<#+         PopIndent(); #>
+<#+         PushIndent(); #>
+<#+     } #>
+<#+ } #>
+
+<#+ private void Output_ApiInformationCall_Pop(ApiInformation apiInformation, Indent indent)#>
+<#+ {#>
+<#+     if (apiInformation != null) { #>
+<#+         PopIndent(); #>
+<#+         PushIndent(indent); #>
+        }
+<#+         PopIndent(); #>
+<#+     } #>
+<#+ } #>
