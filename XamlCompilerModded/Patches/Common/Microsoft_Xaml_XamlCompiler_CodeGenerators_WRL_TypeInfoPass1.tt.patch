diff --git a/Microsoft/Xaml/XamlCompiler/CodeGenerators/WRL_TypeInfoPass1.tt b/Microsoft/Xaml/XamlCompiler/CodeGenerators/WRL_TypeInfoPass1.tt
new file mode 100644
index 0000000..02e7eeb
--- /dev/null
+++ b/Microsoft/Xaml/XamlCompiler/CodeGenerators/WRL_TypeInfoPass1.tt
@@ -0,0 +1,235 @@
+ï»¿<#@ template language="C#" inherits="WRL_CodeGenerator<TypeInfoDefinition>" visibility="internal" linePragmas="false"#>
+<#@ import namespace="Microsoft.Xaml.DirectUI" #>
+//------------------------------------------------------------------------------
+// <auto-generated>
+//     This code was generated by a trole.
+//
+//     Changes to this file may cause incorrect behavior and will be lost if
+//     the code is regenerated.
+// </auto-generated>
+//------------------------------------------------------------------------------
+#pragma once
+
+#include "inc/SimpleArray.h"
+#include "inc/SimpleHashTable.h"
+
+namespace <#=Colonize(ProjectInfo.RootNamespace)#>
+{
+    using IXamlMember = <#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlMember;
+    using IXamlType = <#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlType;
+
+    class XamlTypeInfoProvider final
+        : public ::Microsoft::WRL::RuntimeClass<Microsoft::WRL::RuntimeClassFlags<Microsoft::WRL::ClassicCom>
+            , IUnknown
+        >
+    {
+    public:
+        HRESULT GetXamlTypeByName(HSTRING typeName, IXamlType** ppXamlType);
+        HRESULT GetXamlTypeByType(const <#=Projection(DUI.NamespaceWindowsUIXamlInterop)#>::TypeName& t, IXamlType** ppXamlType);
+        HRESULT GetMemberByLongName(const wchar_t* longMemberName, IXamlMember** ppXamlMember);
+<#  if (!ProjectInfo.GenerateProviderCode) { #>
+        HRESULT AddOtherProvider(<#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlMetadataProvider* otherProvider);
+<#  } #>
+
+    private:
+        CSimpleHashTable<const wchar_t*, ::Microsoft::WRL::WeakRef, CStringHashPolicy, CStringCompare> _xamlTypes; // -> IXamlType
+        CSimpleHashTable<const wchar_t*, ::Microsoft::WRL::ComPtr<IXamlMember>, CStringHashPolicy, CStringCompare> _xamlMembers; // -> IXamlMember
+
+        HRESULT _CreateXamlType(const wchar_t* typeName, IXamlType** ppXamlType);
+        HRESULT _CreateXamlMember(const wchar_t* longMemberName, IXamlMember** ppXamlMember);
+
+        CCoSimpleArray<Microsoft::WRL::ComPtr<<#=Projection(DUI.NamespaceWindowsUIXamlMarkup)#>::IXamlMetadataProvider>> _otherProviders;
+        HRESULT _EnsureOtherProviders();
+
+        HRESULT _CheckOtherMetadataProvidersForName(HSTRING typeName, IXamlType** ppXamlType);
+        HRESULT _CheckOtherMetadataProvidersForType(const <#=Projection(DUI.NamespaceWindowsUIXamlInterop)#>::TypeName& t, IXamlType** ppXamlType);
+    };
+
+    class XamlSystemBaseType final
+        : public ::Microsoft::WRL::RuntimeClass<Microsoft::WRL::RuntimeClassFlags<Microsoft::WRL::WinRt>
+            , IXamlType
+        >
+    {
+        InspectableClass(L"<#=ProjectInfo.RootNamespace#>.XamlSystemBaseType", BaseTrust);
+
+    public:
+        HRESULT RuntimeClassInitialize(const wchar_t* name);
+
+        //~ Begin lType Interface
+        STDMETHODIMP get_BaseType(IXamlType** value) override;
+        STDMETHODIMP get_ContentProperty(IXamlMember** value) override;
+        STDMETHODIMP get_FullName(HSTRING* value) override;
+        STDMETHODIMP get_IsArray(boolean* value) override;
+        STDMETHODIMP get_IsCollection(boolean* value) override;
+        STDMETHODIMP get_IsConstructible(boolean* value) override;
+        STDMETHODIMP get_IsDictionary(boolean* value) override;
+        STDMETHODIMP get_IsMarkupExtension(boolean* value) override;
+        STDMETHODIMP get_IsBindable(boolean* value) override;
+        STDMETHODIMP get_ItemType(IXamlType** value) override;
+        STDMETHODIMP get_KeyType(IXamlType** value) override;
+        STDMETHODIMP get_UnderlyingType(<#=Projection(DUI.NamespaceWindowsUIXamlInterop)#>::TypeName* value) override;
+        STDMETHODIMP ActivateInstance(::IInspectable** result) override;
+        STDMETHODIMP CreateFromString(HSTRING value, ::IInspectable** result) override;
+        STDMETHODIMP GetMember(HSTRING name, IXamlMember** result) override;
+        STDMETHODIMP AddToVector(::IInspectable* instance, ::IInspectable* value) override;
+        STDMETHODIMP AddToMap(::IInspectable* instance, ::IInspectable* key, ::IInspectable* value) override;
+        STDMETHODIMP RunInitializer() override;
+        //~ End IXamlType Interface
+
+        // IsEnum
+        // IsSystemType
+
+    private:
+        ::Microsoft::WRL::Wrappers::HString _fullName;
+    };
+
+    MIDL_INTERFACE("63A5FDC1-874E-4D22-9BC7-A0E3488AD5B2")
+    IXamlUserType : IUnknown
+    {
+        virtual bool IsReturnTypeStub() const = 0;
+        virtual bool IsLocalType() const = 0;
+    };
+
+<#  string xamlTypeInterfaces = $"{Projection(DUI.NamespaceWindowsUIXamlMarkup)}::IXamlType"; #>
+<#
+    xamlTypeInterfaces = Features.NullableTypes.ExistsInVersion(ProjectInfo.TargetPlatformMinVersion) ? (xamlTypeInterfaces + ", " + $"{Projection(DUI.NamespaceWindowsUIXamlMarkup)}::IXamlType2") : xamlTypeInterfaces; #>
+    class XamlUserType final
+        : public ::Microsoft::WRL::RuntimeClass<Microsoft::WRL::RuntimeClassFlags<Microsoft::WRL::WinRtClassicComMix>
+            , <#=xamlTypeInterfaces#>
+            , IXamlUserType
+        >
+    {
+        InspectableClass(L"Windows.UI.Xaml.Markup.IXamlType", BaseTrust);
+
+    public:
+        ~XamlUserType() override;
+
+        HRESULT RuntimeClassInitialize(XamlTypeInfoProvider* provider, const wchar_t* fullName, IXamlType* baseType);
+
+        //~ Begin IXamlType Interface
+        STDMETHODIMP get_BaseType(IXamlType** value) override;
+        STDMETHODIMP get_ContentProperty(IXamlMember** value) override;
+        STDMETHODIMP get_FullName(HSTRING* value) override;
+        STDMETHODIMP get_IsArray(boolean* value) override;
+        STDMETHODIMP get_IsCollection(boolean* value) override;
+        STDMETHODIMP get_IsConstructible(boolean* value) override;
+        STDMETHODIMP get_IsDictionary(boolean* value) override;
+        STDMETHODIMP get_IsMarkupExtension(boolean* value) override;
+        STDMETHODIMP get_IsBindable(boolean* value) override;
+        STDMETHODIMP get_ItemType(IXamlType** value) override;
+        STDMETHODIMP get_KeyType(IXamlType** value) override;
+        STDMETHODIMP get_UnderlyingType(<#=Projection(DUI.NamespaceWindowsUIXamlInterop)#>::TypeName* value) override;
+        STDMETHODIMP ActivateInstance(::IInspectable** result) override;
+        STDMETHODIMP CreateFromString(HSTRING value, ::IInspectable** result) override;
+        STDMETHODIMP GetMember(HSTRING name, IXamlMember** result) override;
+        STDMETHODIMP AddToVector(::IInspectable* instance, ::IInspectable* value) override;
+        STDMETHODIMP AddToMap(::IInspectable* instance, ::IInspectable* key, ::IInspectable* value) override;
+        STDMETHODIMP RunInitializer() override;
+        //~ End IXamlType Interface
+
+<#  if (Features.NullableTypes.ExistsInVersion(ProjectInfo.TargetPlatformMinVersion)) { #>
+        //~ Begin IXamlType2 Interface
+        STDMETHODIMP get_BoxedType(IXamlType** value) override;
+        //~ End IXamlType2 Interface
+
+<#  } #>
+        // Additional Setters
+        void SetArray(bool value);
+        void SetMarkupExtension(bool value);
+        void SetEnum(bool value);
+        void SetBindable(bool value);
+
+        bool IsReturnTypeStub() const override;
+        void SetReturnTypeStub(bool value);
+
+        bool IsLocalType() const override;
+        void SetLocalType(bool value);
+
+        typedef HRESULT (*ActivatorFn)(::IInspectable**);
+        typedef HRESULT (*AddToCollectionFn)(::IInspectable* instance, ::IInspectable* item);
+        typedef HRESULT (*AddToDictionaryFn)(::IInspectable* instance, ::IInspectable* key, ::IInspectable* item);
+        typedef HRESULT (*CreateFromStringFn)(HSTRING input, ::IInspectable**);
+        typedef HRESULT (*StringConverterFn)(XamlUserType* userType, HSTRING input, ::IInspectable**);
+
+        ActivatorFn _activator{};
+        AddToCollectionFn _collectionAdd{};
+        AddToDictionaryFn _dictionaryAdd{};
+        CreateFromStringFn _createFromStringMethod{};
+        <#=Projection(DUI.NamespaceWindowsUIXamlInterop)#>::TypeKind _kindOfType{};
+        StringConverterFn _fromStringConverter{};
+
+        HRESULT SetContentPropertyName(const wchar_t* value);
+        HRESULT SetItemTypeName(const wchar_t* value);
+        HRESULT SetKeyTypeName(const wchar_t* value);
+<#  if (Features.NullableTypes.ExistsInVersion(ProjectInfo.TargetPlatformMinVersion)) { #>
+        void SetBoxedType(IXamlType* boxedType);
+<#  } #>
+        HRESULT AddMemberName(const wchar_t* pszShortName);
+        HRESULT AddEnumValue(const wchar_t* name, ::IInspectable* value);
+        HRESULT CreateEnumUIntFromString(HSTRING input, UINT* result) const;
+
+    private:
+        ::Microsoft::WRL::ComPtr<XamlTypeInfoProvider> _provider;
+        ::Microsoft::WRL::ComPtr<IXamlType> _baseType;
+<#  if (Features.NullableTypes.ExistsInVersion(ProjectInfo.TargetPlatformMinVersion)) { #>
+        ::Microsoft::WRL::ComPtr<IXamlType> _boxedType;
+<#  } #>
+        ::Microsoft::WRL::Wrappers::HString _contentPropertyName;
+        ::Microsoft::WRL::Wrappers::HString _itemTypeName;
+        ::Microsoft::WRL::Wrappers::HString _keyTypeName;
+        ::Microsoft::WRL::Wrappers::HString _fullName;
+        CSimpleHashTable<const wchar_t*, const wchar_t*, CStringHashPolicy, CStringCompare> _memberNames;
+        CSimpleHashTable<const wchar_t*, ::Microsoft::WRL::ComPtr<::IInspectable>, CStringHashPolicy, CStringCompare> _enumValues;
+        bool _isArray{ false };
+        bool _isMarkupExtension{ false };
+        bool _isEnum{ false };
+        bool _isBindable{ false };
+        bool _isReturnTypeStub{ false };
+        bool _isLocalType{ false };
+    };
+
+    class XamlMember final
+        : public ::Microsoft::WRL::RuntimeClass<Microsoft::WRL::RuntimeClassFlags<Microsoft::WRL::WinRt>
+            , IXamlMember
+        >
+    {
+        InspectableClass(L"<#=ProjectInfo.RootNamespace#>.XamlMember", BaseTrust);
+
+    public:
+        XamlMember();
+
+        HRESULT RuntimeClassInitialize(XamlTypeInfoProvider* provider, const wchar_t* name, const wchar_t* typeName);
+
+        typedef HRESULT (*PropertyGetterFn)(::IInspectable* instance, ::IInspectable**);
+        typedef HRESULT (*PropertySetterFn)(::IInspectable* instance, ::IInspectable* value);
+
+        PropertyGetterFn _getter{};
+        PropertySetterFn _setter{};
+
+        //~ Begin IXamlMember Interface
+        STDMETHODIMP get_IsAttachable(boolean* value) override;
+        STDMETHODIMP get_IsDependencyProperty(boolean* value) override;
+        STDMETHODIMP get_IsReadOnly(boolean* value) override;
+        STDMETHODIMP get_Name(HSTRING* value) override;
+        STDMETHODIMP get_TargetType(IXamlType** value) override;
+        STDMETHODIMP get_Type(IXamlType** value) override;
+        STDMETHODIMP GetValue(::IInspectable* instance, ::IInspectable** result) override;
+        STDMETHODIMP SetValue(::IInspectable* instance, ::IInspectable* value) override;
+        //~ End IXamlMember Interface
+
+        // Additional Setters
+        HRESULT SetTargetTypeName(const wchar_t* value);
+        void SetAttachable(bool value);
+        void SetDependencyProperty(bool value);
+        void SetReadOnly(bool value);
+
+    private:
+        bool _isAttachable{ false };
+        bool _isDependencyProperty{ false };
+        bool _isReadOnly{ false };
+        ::Microsoft::WRL::Wrappers::HString _name;
+        ::Microsoft::WRL::Wrappers::HString _targetTypeName;
+        ::Microsoft::WRL::Wrappers::HString _typeName;
+        ::Microsoft::WRL::ComPtr<XamlTypeInfoProvider> _provider;
+    };
+}
